<div data-def-template="dropdown(entries,metadata)">

    <select id="dropdown" data-bind="entries">
        <option>
            <script>
                dobi.script(function(info) {

                    var metadata = info.resolve('metadata').value();

                    var selectedEntryProperty = info.resolve('../');
                    var selectedValue = selectedEntryProperty.resolve(metadata.valuePath).value();

                    var entryProperty = info.resolve('.');
                    var value = entryProperty.resolve(metadata.valuePath).value();
                    var description = entryProperty.resolve(metadata.descriptionPath).value();

                    info.parentNode.setAttribute('value', value);
                    info.parentNode.textContent = description;

                    if (selectedEntryProperty.value() === entryProperty.value())
                        info.parentNode.setAttribute('selected', 'selected');
                    else
                        info.parentNode.removeAttribute('selected');

                });
            </script>
        </option>
    </select>

    <script>
        dobi.script(function(info) {

            var metadata = info.resolve('metadata').value();
            var dropdown = info.getElementById('dropdown');
            var entriesProperty = info.resolve('entries');
            var selectedEntryProperty = info.resolve('.');

            dropdown.addEventListener('click', function() {
                for (var i = 0; i < entriesProperty.value().length; ++i) {
                    var entryProperty = entriesProperty.resolve("" + i);
                    var value = entryProperty.resolve(metadata.valuePath).value();
                    if (value === dropdown.value) {
                        selectedEntryProperty.set(entryProperty.value());
                    }
                }
            });

        });
    </script>

</div>
