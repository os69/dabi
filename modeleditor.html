<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
    <script src="../lib/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="eventing.js"></script>
    <script src="dobi.js"></script>

    <title>Binding Declarative Approach</title>
</head>

<body>

    <div id="templates">


        <!-- model -->
        <div data-bind="editor/model">

            <ul data-bind="Dimensions/0/Attributes">
                <li>
                    <span data-bind="Id"></span>
                    <span data-bind="Name"></span>
                    <input type="checkbox" data-bind="AccessUsage.FreestyleSearch">
                    <ul data-bind="dict:PresentationUsage">
                        <li>
                            <input data-bind="key">
                            <input data-bind="value">
                        </li>
                    </ul>
                </li>
            </ul>

            <ul data-bind="Dimensions[0].Attributes">
                <li>
                    <span data-bind="Id"></span>
                    <span data-bind="Name"></span>
                    <input type="checkbox" data-bind="AccessUsage.FreestyleSearch">
                    <ul data-bind="dict:PresentationUsage">
                        <li>
                            <input data-bind="key">
                            <input data-bind="value">
                            <button id="delpu">del</button>
                        </li>
                    </ul>
                </li>
            </ul>

        </div>

        <!-- dimensions -->
        <div data-def-template="dropdown">
            <select id="dropdown" data-bind="param0">
                <option value="{{name}}">
                    {{description}}
                    <script>
                        dobi.script(function(info) {
                            var selectedProperty = info.resolve('../self');
                            dobi.bindAttributeToElementAttribute(selectedProperty, 'selected', info.parentNode, function(value) {
                                if (info.resolve('self/name').value() === value.name)
                                    return 'selected';
                                else
                                    return '$remove';
                            });
                        });
                    </script>
                </option>
            </select>
            <script>
                dobi.script(function(info) {
                    var list = info.resolve('param0').value();
                    var dropdown = info.getElementById('dropdown');
                    var selectedProperty = info.resolve('self');
                    dropdown.addEventListener('click', function() {
                        for (var i = 0; i < list.length; ++i) {
                            var element = list[i];
                            if (element.name === dropdown.value) {
                                selectedProperty.set(element);
                                break;
                            }
                        }
                    });
                });
            </script>
        </div>


        <div data-bind="editor/cube">

            <h1>Cube</h1>

            <h2>Dimensions</h2>
            <div data-bind="currentDimension" data-template="dropdown" data-template-parameters="dimensionList"></div>
            <h2>Attributes</h2>

            <div data-bind="currentDimension">
                <ul data-bind="dimension/Attributes">
                    <li data-bind="Name"></li>
                </ul>
            </div>

        </div>

    </div>
    <div id="target"></div>
    <script src="modeleditor.js"></script>


</body>

</html>