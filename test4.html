<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">

    <LINK href="test2.css" rel="stylesheet" type="text/css">
    <!--    <script src="../lib/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="../lib/require.js" data-main="test3.js"></script>-->

    <script src="eventing.js"></script>
    <script src="dombinding.js"></script>
    <title>Binding Declarative Approach</title>

</head>

<body>


    <div data-bind="salesOrder">
        <h1>Sales Order:
           
        </h1>

         <input data-bind="description">
        
        <h2>Status</h2>
        <div data-bind="status">
            Status code:
            <span data-bind="code"></span>
            <br>Description:
            <span data-bind="description"></span>
        </div>

        <h2>Items</h2>
        <ul data-bind="items">
            <li>
                <span data-bind="description"></span>
                <ul data-bind="subitems">
                    <li>
                        <input data-bind="$self">
                        <span data-bind="$self"></span>
                    </li>
                </ul>
                <button id="delitems">Del</button>
                <script>
                    dombinding.templateScript(function(ctx,item,list){
                        var delButton=document.getElementById("delitems#"+ctx.id);
                        delButton.addEventListener('click',function(){
                            var index = list.indexOf(item);
                            list.splice(index,1);
                        })
                    });
                </script>
            </li>
        </ul>
        <button id="additem">Add</button>
        <script>
            dombinding.templateScript(function(ctx,salesOrder){
                var addButton=document.getElementById("additem#"+ctx.id);
                addButton.addEventListener('click',function(){
                    salesOrder.items.push({description:'new', subitems:['a']});
                });
            });
        </script>
    </div>

    <div id="testtext"></div>
    
    <script>
        salesOrder = {
                    id: 10,
                    description: 'Big Order',
                    status: {
                        code: 1,
                        description: 'Status 1'
                    },
                    items: [
                        {
                            description: 'item1',
                            subitems: ['a', 'b', 'c']
                    },
                        {
                            description: 'item2',
                            subitems: ['x', 'y', 'z']
                    }
                ]
                };
        
     
    </script>


</body>

</html>